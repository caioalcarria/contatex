<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Clientes e Contatos</title>
    <style>
      /* Estilo básico para a tabela */
      table {
        border-collapse: collapse;
        width: 100%;
      }
      th, td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
      th {
        background-color: #f2f2f2;
      }
    </style>
  </head>
  <body>
    <h1>Clientes e Contatos</h1>

    <h2>Clientes</h2>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nome</th>
          <th>Email</th>
          <th>Telefone</th>
          <th>Setor</th>
          <th>Contatos</th>
        </tr>
      </thead>
      <tbody id="clients-table-body"></tbody>
    </table>

    <h2>Contatos</h2>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nome</th>
          <th>Email</th>
          <th>Telefone</th>
          <th>Setor</th>
          <th>Cliente</th>
        </tr>
      </thead>
      <tbody id="contacts-table-body"></tbody>
    </table>

    <script>
      // Função para fazer uma requisição GET e retornar os dados como JSON
      function getData(url) {
        return fetch(url).then(response => response.json());
      }

      // Renderiza a tabela de clientes
      getData('https://full-stack-challenge.onrender.com/clients')
        .then(clients => {
          const clientsTableBody = document.querySelector('#clients-table-body');
          clients.forEach(client => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${client.id}</td>
              <td>${client.name}</td>
              <td>${client.email}</td>
              <td>${client.phone}</td>
              <td>${client.sector}</td>
              <td>${client.contacts.map(contact => contact.name).join(', ')}</td>
            `;
            clientsTableBody.appendChild(row);
          });
        });

      // Renderiza a tabela de contatos
      getData('https://full-stack-challenge.onrender.com/contacts')
        .then(contacts => {
          const contactsTableBody = document.querySelector('#contacts-table-body');
          contacts.forEach(contact => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${contact.id}</td>
              <td>${contact.name}</td>
              <td>${contact.email}</td>
              <td>${contact.phone}</td>
              <td>${contact.sector}</td>
              <td>${contact.client ? contact.client.name : '-'}</td>
            `;
            contactsTableBody.appendChild(row);
          });
        });
    </script>
  </body>
</html>